{% extends 'base.html' %}
{% load static %}

{% block content %}
    <div class="container">
        <section class="page-header">
            <h1 class="page-title">Races</h1>
            <a href="{% url 'races:race_create' %}" class="btn primary">+ Add Race</a>
        </section>

        <div class="feature-card race-results">
            {% for race in races_with_results %}
                <div class="result-item team-content" style="gap: 5em">
                    <div>
                        <h3>{{ race.name }}</h3>
                        <p>Round {{ race.round_number }} · {{ race.track.name }} Circuit</p>
                        <div class="actions">
                            <a href="{% url 'races:race_details' race.pk %}" class="card-btn ">Details</a>
                        </div>
                    </div>
                    <div class="driver-positions">
                        <ul class="results-list">
                            {% for result in race.results.all|slice:":3" %}
                                <li>
                                    <p>
                                        {% if result.status != "Finished" %}
                                            <span style="color: darkred"><strong>{{ result.status }}</strong></span>
                                        {% else %}
                                            <strong>{{ result.display_finishing_position }}.</strong>
                                        {% endif %}
                                        {{ result.driver.nationality }} —
                                        <strong>{{ result.driver.name }} —</strong>
                                        {{ result.driver.team }}
                                        — {{ result.points_awarded }} pts
                                    </p>
                                </li>
                            {% endfor %}
                        </ul>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
{% endblock %}